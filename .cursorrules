# ğŸš€ Cursor Rules - Template Laravel 12

## ğŸ“‹ VisÃ£o Geral
Este arquivo define as regras e melhores prÃ¡ticas para desenvolvimento com este template Laravel 12, incluindo padrÃµes de cÃ³digo, estrutura de arquivos e ferramentas de qualidade.

## ğŸ—ï¸ Estrutura do Projeto

### DiretÃ³rios Principais
- `app/` - CÃ³digo da aplicaÃ§Ã£o Laravel
- `config/` - Arquivos de configuraÃ§Ã£o
- `database/` - MigraÃ§Ãµes, seeders, factories
- `routes/` - DefiniÃ§Ã£o de rotas
- `storage/` - Arquivos gerados pela aplicaÃ§Ã£o
- `tests/` - Testes automatizados
- `resources/` - Views, assets, linguagens
- `public/` - Arquivos pÃºblicos

### PadrÃµes de Nomenclatura
- **Controllers**: `UserController`, `PostController` (sufixo Controller)
- **Models**: `User`, `Post`, `Comment` (singular, PascalCase)
- **Services**: `UserService`, `EmailService` (sufixo Service)
- **Repositories**: `UserRepository`, `PostRepository` (sufixo Repository)
- **Requests**: `UserRequest`, `PostRequest` (sufixo Request)
- **Resources**: `UserResource`, `PostResource` (sufixo Resource)

## ğŸ“ PadrÃµes de CÃ³digo

### PHP (Laravel)
- **PadrÃ£o**: PSR-12 estritamente
- **IndentaÃ§Ã£o**: 4 espaÃ§os
- **Chaves**: Na mesma linha para classes e mÃ©todos
- **Tipagem**: Sempre usar type hints e return types
- **Propriedades**: Usar `readonly` quando possÃ­vel
- **Construtor**: Usar constructor property promotion

### Exemplo de Controller
```php
<?php

namespace App\Http\Controllers;

use App\Http\Requests\UserRequest;
use App\Models\User;
use App\Services\UserService;
use Illuminate\Http\JsonResponse;

class UserController extends Controller
{
    public function __construct(
        private readonly UserService $userService
    ) {}

    public function index(): JsonResponse
    {
        $users = $this->userService->getAllUsers();

        return response()->json($users);
    }

    public function store(UserRequest $request): JsonResponse
    {
        $user = $this->userService->createUser($request->validated());

        return response()->json($user, 201);
    }
}
```

### Exemplo de Service
```php
<?php

namespace App\Services;

use App\Models\User;
use App\Repositories\UserRepository;
use Illuminate\Support\Facades\Hash;

class UserService
{
    public function __construct(
        private readonly UserRepository $userRepository
    ) {}

    public function createUser(array $data): User
    {
        $data['password'] = Hash::make($data['password']);

        return $this->userRepository->create($data);
    }
}
```

### Exemplo de Model
```php
<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Database\Eloquent\Model;
use Illuminate\Database\Eloquent\Relations\HasMany;

class User extends Model
{
    use HasFactory;

    protected $fillable = [
        'name',
        'email',
        'password',
    ];

    protected $hidden = [
        'password',
        'remember_token',
    ];

    protected $casts = [
        'email_verified_at' => 'datetime',
        'password' => 'hashed',
    ];

    public function posts(): HasMany
    {
        return $this->hasMany(Post::class);
    }
}
```

## ğŸ” Ferramentas de Qualidade

### AnÃ¡lise EstÃ¡tica
- **PHPStan**: Level 8 (mÃ¡ximo rigor) - **PRINCIPAL FERRAMENTA**
- **Laravel Pint**: FormataÃ§Ã£o automÃ¡tica
- **PHP CS Fixer**: PSR-12 compliance

### Comandos de Qualidade
```bash
# VerificaÃ§Ã£o completa
make quality

# AnÃ¡lise estÃ¡tica
make stan          # PHPStan

# FormataÃ§Ã£o
make pint          # Laravel Pint
make cs-check      # Verificar PSR-12
make cs-fix        # Corrigir PSR-12
```

## ğŸ§ª Testes

### Estrutura de Testes
- **Feature Tests**: `tests/Feature/` - Testes de funcionalidade
- **Unit Tests**: `tests/Unit/` - Testes unitÃ¡rios
- **Database**: Usar `RefreshDatabase` trait
- **Factories**: Criar factories para todos os models

### Exemplo de Teste
```php
<?php

namespace Tests\Feature;

use App\Models\User;
use Illuminate\Foundation\Testing\RefreshDatabase;
use Tests\TestCase;

class UserTest extends TestCase
{
    use RefreshDatabase;

    public function test_can_create_user(): void
    {
        $userData = [
            'name' => 'John Doe',
            'email' => 'john@example.com',
            'password' => 'password123',
        ];

        $response = $this->postJson('/api/users', $userData);

        $response->assertStatus(201)
                ->assertJsonStructure([
                    'id',
                    'name',
                    'email',
                    'created_at',
                ]);

        $this->assertDatabaseHas('users', [
            'email' => 'john@example.com',
        ]);
    }
}
```

## ğŸ³ Docker e Ambiente

### Laravel Sail
- **Comando**: `./vendor/bin/sail`
- **Alias**: `make sail-up`, `make sail-down`
- **Portas**: 80 (Laravel), 3306 (MySQL), 6379 (Redis)

### ServiÃ§os DisponÃ­veis
- Laravel: http://localhost
- MySQL: localhost:3306
- Redis: localhost:6379
- Meilisearch: http://localhost:7700
- Mailpit: http://localhost:8025

## ğŸš€ Desenvolvimento

### Workflow Recomendado
1. **Setup**: `./scripts/setup.sh`
2. **Desenvolvimento**: `make sail-up` + `make watch`
3. **Antes do Commit**: `make quality`
4. **Testes**: `make test`

### Comandos Essenciais
```bash
# Setup inicial
./scripts/setup.sh

# Desenvolvimento
make sail-up          # Iniciar Docker
make watch            # Hot reload
make quality          # Verificar qualidade

# Testes
make test             # Executar testes
make test-coverage    # Com cobertura

# Deploy
make optimize         # Otimizar para produÃ§Ã£o
make build            # Compilar assets
```

## ğŸ“š Recursos e DocumentaÃ§Ã£o

### Links Ãšteis
- [Laravel 12 Documentation](https://laravel.com/docs)
- [PHPStan Documentation](https://phpstan.org/)
- [Laravel Pint](https://laravel.com/docs/pint)
- [Laravel Sail](https://laravel.com/docs/sail)

### Arquivos de ConfiguraÃ§Ã£o
- `composer.json` - DependÃªncias PHP
- `package.json` - DependÃªncias Node.js
- `phpstan.neon` - ConfiguraÃ§Ã£o PHPStan
- `pint.json` - ConfiguraÃ§Ã£o Laravel Pint
- `phpcs.xml` - ConfiguraÃ§Ã£o PSR-12
- `.eslintrc.js` - ConfiguraÃ§Ã£o ESLint
- `tsconfig.json` - ConfiguraÃ§Ã£o TypeScript

## âš ï¸ Regras Importantes

### âŒ NÃƒO FAZER
- NÃ£o commitar arquivos `.env`
- NÃ£o commitar `vendor/` ou `node_modules/`
- NÃ£o usar `DB::raw()` sem sanitizaÃ§Ã£o
- NÃ£o deixar queries N+1
- NÃ£o commitar cÃ³digo nÃ£o formatado
- **NÃƒO COMMITAR AUTOMATICAMENTE** - Sempre revisar antes
- **NÃƒO FAZER PUSH AUTOMATICAMENTE** - Sempre verificar qualidade primeiro

### âœ… SEMPRE FAZER
- Executar `make quality` antes do commit
- Usar type hints e return types
- Seguir PSR-12 estritamente
- Escrever testes para novas funcionalidades
- Documentar mÃ©todos complexos
- Usar dependency injection
- **REVISAR CÃ“DIGO** antes de commitar
- **EXECUTAR TESTES** antes de fazer push
- **VERIFICAR QUALIDADE** com ferramentas configuradas

### ğŸ”§ Boas PrÃ¡ticas
- **SOLID Principles**: Aplicar sempre que possÃ­vel
- **Repository Pattern**: Para acesso a dados
- **Service Layer**: Para lÃ³gica de negÃ³cio
- **Form Requests**: Para validaÃ§Ã£o
- **API Resources**: Para transformaÃ§Ã£o de dados
- **Events & Listeners**: Para aÃ§Ãµes assÃ­ncronas
- **Jobs & Queues**: Para tarefas pesadas

## ğŸš« Controle de VersÃ£o - REGRAS CRÃTICAS

### âš ï¸ NUNCA AUTOMATIZAR
- **Commits automÃ¡ticos** sÃ£o PROIBIDOS
- **Push automÃ¡tico** Ã© PROIBIDO
- **Deploy automÃ¡tico** sem revisÃ£o Ã© PROIBIDO

### ğŸ”’ Processo ObrigatÃ³rio
1. **Desenvolver** funcionalidade
2. **Executar** `make quality` para verificar qualidade
3. **Executar** `make test` para verificar testes
4. **Revisar** cÃ³digo manualmente
5. **Commitar** com mensagem descritiva
6. **Fazer push** apenas apÃ³s revisÃ£o completa

### ğŸŒ Idioma dos Commits
- **OBRIGATÃ“RIO**: Todos os commits devem ser em **PORTUGUÃŠS BRASILEIRO (pt-BR)**
- **NÃƒO USAR**: InglÃªs, espanhol ou outros idiomas
- **PADRÃƒO**: Usar verbos no infinitivo e linguagem tÃ©cnica em portuguÃªs

### ğŸ“ Mensagens de Commit
```bash
# Formato correto (pt-BR)
git commit -m "feat: adiciona autenticaÃ§Ã£o de usuÃ¡rios

- Implementa sistema de login/logout
- Adiciona middleware de autenticaÃ§Ã£o
- Cria testes para funcionalidades
- Atualiza documentaÃ§Ã£o"

# Formato incorreto (inglÃªs)
git commit -m "feat: add user authentication"  # âŒ NÃƒO USAR INGLÃŠS

# Formato incorreto (vago)
git commit -m "fix"  # âŒ Muito vago
git commit -m "updates"  # âŒ NÃ£o descritivo
```

### ğŸ“š Exemplos de Commits em PortuguÃªs
```bash
# Funcionalidades
git commit -m "feat: implementa sistema de notificaÃ§Ãµes por email"
git commit -m "feat: adiciona dashboard administrativo"
git commit -m "feat: cria API para gerenciamento de produtos"

# CorreÃ§Ãµes
git commit -m "fix: corrige validaÃ§Ã£o de CPF no formulÃ¡rio"
git commit -m "fix: resolve problema de cache no Redis"
git commit -m "fix: ajusta timezone para horÃ¡rio de BrasÃ­lia"

# Melhorias
git commit -m "perf: otimiza consultas do banco de dados"
git commit -m "refactor: reorganiza estrutura de diretÃ³rios"
git commit -m "style: aplica formataÃ§Ã£o PSR-12"

# DocumentaÃ§Ã£o
git commit -m "docs: atualiza README com instruÃ§Ãµes de instalaÃ§Ã£o"
git commit -m "docs: adiciona comentÃ¡rios no cÃ³digo"
git commit -m "docs: cria guia de deploy para produÃ§Ã£o"
```

## ğŸ¯ Dicas de Produtividade

### IDE Setup
- **PHPStorm**: Laravel Plugin + PHPStan
- **VS Code**: PHP Intelephense + Laravel Snippets
- **Vim/Neovim**: ALE + PHPStan

### ExtensÃµes Recomendadas
- PHP Intelephense
- Laravel Blade Snippets
- PHP Debug
- PHP CS Fixer
- Tailwind CSS IntelliSense

### Atalhos Ãšteis
- `make help` - Ver todos os comandos
- `make quality` - VerificaÃ§Ã£o completa
- `make fresh` - Recriar banco
- `make cache-clear` - Limpar caches

---

**ğŸ‰ Lembre-se: Qualidade de cÃ³digo Ã© prioridade! Sempre execute `make quality` antes de commitar.**

**ğŸš« IMPORTANTE: NUNCA commite ou faÃ§a push automaticamente. Sempre revise e verifique a qualidade do cÃ³digo primeiro!**

**ğŸ‡§ğŸ‡· OBRIGATÃ“RIO: Todos os commits devem ser em PORTUGUÃŠS BRASILEIRO (pt-BR)!**
